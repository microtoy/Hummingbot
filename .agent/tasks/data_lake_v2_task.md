# Data Lake V2 å¼€å‘ç»­èˆªä»»åŠ¡æ¸…å•

> **æ¥æº**: ä» `.agent/system_knowledge/working.md` æå–çš„å¾…åŠäº‹é¡¹  
> **æ›´æ–°**: 2026-01-09

---

## ğŸ”´ å¾…å®ŒæˆåŠŸèƒ½

### 1. ä¸‹è½½å®Œæˆå UI çŠ¶æ€åˆ‡æ¢
- [ ] ä¸‹è½½ç»“æŸåï¼Œ"æš‚åœ/æ¢å¤"æŒ‰é’®å˜ä¸º **"ğŸ”§ ä¿®å¤æ•°æ®"**
- [ ] ç‚¹å‡»ä¿®å¤åï¼Œç³»ç»Ÿè‡ªåŠ¨æ‰«æå¹¶è¡¥å…¨å› ä¸‹è½½é”™è¯¯ç¼ºå¤±çš„æ•°æ®åˆ†ç‰‡
- [ ] ä¿®å¤å®Œæˆåæ›´æ–°æ•°æ®èµ„äº§çŠ¶æ€

### 2. æ•°æ®èµ„äº§çŠ¶æ€åå‘æ›´æ–°
- [ ] ä¸‹è½½/ä¿®å¤å®Œæˆåï¼Œè‡ªåŠ¨åˆ·æ–°"ğŸ“‹ æ•°æ®èµ„äº§æ¦‚è§ˆ"ä¸­çš„ç»Ÿè®¡æ•°æ®
- [ ] æ›´æ–°"æ•°æ®å¥åº·ä¸å¸¦"å¯è§†åŒ–

### 3. V1/V2 æ•°æ®ä¸€è‡´æ€§ä¿éšœ
- [ ] ç¡®ä¿åˆå¹¶åçš„ CSV ä¸ V1 ä¸‹è½½æ ¼å¼ 100% ä¸€è‡´
- [ ] éªŒè¯æ—¶é—´æˆ³å•ä½ç»Ÿä¸€ä¸ºç§’ï¼ˆéæ¯«ç§’ï¼‰
- [ ] éªŒè¯åˆ—åä¸ V1 æ ¼å¼å®Œå…¨åŒ¹é…

---

## âœ… å·²å®Œæˆæ ¸å¿ƒåŠŸèƒ½

| æ¨¡å— | æ–‡ä»¶è·¯å¾„ | è¯´æ˜ |
|------|----------|------|
| æ•°æ®æ¹–æ ¸å¿ƒ | `data/data_lake/` | æŒ‰å¤©åˆ†ç‰‡å­˜å‚¨ï¼Œå¤šçº¿ç¨‹ä¸‹è½½ |
| å‰ç«¯ç•Œé¢ | `pages/data/data_lake_v2/app.py` | Dashboard UI |
| ä¸‹è½½å™¨ | `data/data_lake/downloader.py` | 10 çº¿ç¨‹å¹¶å‘ |
| åˆå¹¶å™¨ | `data/data_lake/merger.py` | åˆ†ç‰‡ â†’ å•æ–‡ä»¶ |
| å­˜å‚¨ç®¡ç† | `data/data_lake/storage.py` | åˆ†åŒºè·¯å¾„ç®¡ç† |
| æ•°æ®è·å– | `data/data_lake/fetcher.py` | Binance API è°ƒç”¨ |

---

## âš ï¸ å·²çŸ¥é—®é¢˜ä¸ä¿®å¤è®°å½•

1. **æ—¶é—´æˆ³å•ä½æ··ç”¨ (ms/s)** â†’ å·²åœ¨ `merger.py` ä¸­å¼ºåˆ¶å½’ä¸€åŒ–ä¸ºç§’
2. **å›æµ‹ float indexer é”™è¯¯** â†’ å·²åœ¨ `backtesting_engine_base.py` è¡¥ä¸ä¸­ä¿®å¤
3. **ä¸‹è½½åæ–‡ä»¶åªæœ‰è¡¨å¤´æ— æ•°æ®** â†’ å·²åœ¨ `fetcher.py` ä¸­ä¿®å¤
4. **`position_executor_simulator.py` æŒ‚è½½å†²çª** â†’ å·²ç§»é™¤è¯¥è¡¥ä¸

---

## ğŸ“ å…³é”®æ–‡ä»¶è·¯å¾„

```
deploy/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ data_lake/          # V2 æ ¸å¿ƒä»£ç 
â”‚   â”‚   â”œâ”€â”€ downloader.py   # å¤šçº¿ç¨‹ä¸‹è½½è°ƒåº¦
â”‚   â”‚   â”œâ”€â”€ fetcher.py      # Binance API è·å–
â”‚   â”‚   â”œâ”€â”€ merger.py       # åˆ†ç‰‡åˆå¹¶
â”‚   â”‚   â”œâ”€â”€ storage.py      # åˆ†åŒºå­˜å‚¨ç®¡ç†
â”‚   â”‚   â””â”€â”€ manager.py      # ç»Ÿä¸€ç®¡ç†å…¥å£
â”‚   â”œâ”€â”€ lake/               # åˆ†ç‰‡æ•°æ®å­˜å‚¨ç›®å½•
â”‚   â””â”€â”€ candles/            # V1 æ ¼å¼åˆå¹¶æ–‡ä»¶
â”œâ”€â”€ pages/data/data_lake_v2/
â”‚   â””â”€â”€ app.py              # Dashboard å‰ç«¯
â””â”€â”€ .agent/system/patches/
    â”œâ”€â”€ backtesting_engine_base.py
    â””â”€â”€ backtesting_router.py
```

---

## ğŸ’¡ ä¸‹æ¬¡å¼€å‘å»ºè®®

1. **ä¼˜å…ˆå®Œæˆ**ï¼šä¸‹è½½å®Œæˆåçš„"ä¿®å¤æ•°æ®"æŒ‰é’®é€»è¾‘
2. **æµ‹è¯•éªŒè¯**ï¼šä½¿ç”¨ `verification_suite.py` éªŒè¯å›æµ‹ä¸€è‡´æ€§
3. **Git æäº¤**ï¼šæ¯ä¸ªåŠŸèƒ½ç‚¹å®ŒæˆååŠæ—¶æäº¤
